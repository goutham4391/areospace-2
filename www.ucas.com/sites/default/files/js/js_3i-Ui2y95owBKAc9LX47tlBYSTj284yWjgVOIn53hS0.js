!function(e){"use strict";var t={container:!1,tabs:!1,innerForm:!1,message:!1,highlightElement:!1,highLightLeft:20,highLightRight:705,activeFormType:"allForm",subDomain:"www",init:function(e){t.container=e,e.innerHTML='<div class="global-search__wrapper">  <div class="global-search__tabs">    <div class="global-search__tab-highlight" style="left: 20px;"></div>    <button class="global-search__tab" type="button" data-tab-target="allForm">All results</button>    <button class="global-search__tab" type="button" data-tab-target="courseForm">Courses</button>    <button class="global-search__tab" type="button" data-tab-target="uniForm">Uni & colleges</button>    <button class="global-search__tab" type="button" data-tab-target="apprenticeshipsForm">Apprenticeships</button>    <button class="global-search__tab" type="button" data-tab-target="adviceForm">Advice</button>    <button class="global-search__tab" type="button" data-tab-target="eventsForm">Events</button>    <div class="global-search__tab-spacer">&nbsp;</div>  </div>  <div class="global-search__dynamic-form">'+t.fetchForm(t.activeFormType)+'  </div>  <input type="submit" value="Submit" class="global-search__form-submit" /></div><div class="global-search__message" style="display: none;"></div>',t.innerForm=e.querySelectorAll(".global-search__dynamic-form").item(0),t.message=e.querySelectorAll(".global-search__message").item(0),t.highlightElement=e.querySelectorAll(".global-search__tab-highlight").item(0),t.tabs=e.querySelectorAll(".global-search__tab"),t.toggleForm(),t.tabs&&t.tabs.forEach((function(e,o){e.addEventListener("click",t.tabClick)})),e.addEventListener("submit",t.submitForm,!0)},submitForm:function(e){e.preventDefault(),t.hideMessage();var o=e.target,a={};Object.keys(o.elements).forEach((function(e){var t=o.elements[e];"submit"!==t.type&&(a[t.name]=t.value)}));var n=t.fetchDestination(a);n?window.location=n:t.showMessage('Start typing the name of a uni or college and select from the drop down or <a href="'+t.getDomain()+'/explore/unis">browse all</a>.')},tabClick:function(e){e.preventDefault(),t.hideMessage(),t.container.classList.remove("global-search__form-"+t.activeFormType),t.activeFormType=e.target.dataset.tabTarget,t.toggleForm(),t.container.classList.add("global-search__form-"+t.activeFormType)},toggleForm:function(){var e=t.container.querySelectorAll('[data-tab-target="'+t.activeFormType+'"]').item(0);t.innerForm.innerHTML=t.fetchForm(t.activeFormType),t.highlightElement.style.left=Math.floor(e.offsetLeft)+"px",t.highlightElement.style.width=Math.floor(e.offsetWidth)+"px",t.resetTabs(),e.classList.add("global-search__tab--active")},resetTabs:function(){t.tabs.forEach((function(e){e.classList.remove("global-search__tab--active")}))},hideMessage:function(){t.message.classList.remove("global-search__message--active")},showMessage:function(e){t.message.classList.add("global-search__message--active"),t.message.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),t.message.innerHTML=e},fetchForm:function(o){switch(o){case"allForm":return'<input name="allFormquery" maxlength="128" type="text" placeholder="Search for courses, uni & colleges and information" autocomplete="off" />';case"courseForm":return'<select name="destination">  <option value="Undergraduate">Undergraduate</option>  <option value="Postgraduate">Postgraduate</option>  <option value="Conservatoire">Conservatoire</option></select><select name="regions">  <option value="_none">Location (optional)</option>  <option value="England">England</option>  <option value="Scotland">Scotland</option>  <option value="Northern Ireland">Northern Ireland</option>  <option value="Wales">Wales</option>  <option value="Outside of the UK">Outside of the UK</option>  <option value="South East England">South East England</option>  <option value="North East England">North East England</option>  <option value="South West England">South West England</option>  <option value="North West England">North West England</option>  <option value="East of England">East of England</option>  <option value="West Midlands">West Midlands</option>  <option value="East Midlands">East Midlands</option>  <option value="Greater London">Greater London</option>  <option value="Yorkshire and the Humber">Yorkshire and the Humber</option></select><input name="courseFormsearchTerm" maxlength="128" type="text" placeholder="Subject" autocomplete="off" />';case"uniForm":return e.ajax({url:"/api/v1/unis",success:t.initAutocomplete}),'<input name="searchTerm" maxlength="128" type="text" placeholder="University or college name" autocomplete="off" />';case"apprenticeshipsForm":return'<input name="apprenticeshipsFormquery" maxlength="128" type="text" placeholder="Search for apprenticeships, graduate jobs, and internships" autocomplete="off" />';case"adviceForm":return'<input name="adviceFormquery" maxlength="128" type="text" placeholder="Search for information and advice" autocomplete="off" />';case"eventsForm":return'<input name="eventsFormquery" maxlength="128" type="text" placeholder="Search for events and open days" autocomplete="off" />'}},fetchDestination:function(e){switch(t.activeFormType){case"allForm":return t.subDomain="www",t.getDomain()+"/explore/search?"+t.objectToQueryString(e);case"courseForm":return t.subDomain="digital","Conservatoire"===e.destination&&(e.destination="Undergraduate",e.schemes="UCAS Conservatoires"),t.getDomain()+"/coursedisplay/results?"+t.objectToQueryString(e);case"uniForm":return t.subDomain="www",!1;case"adviceForm":return t.subDomain="www",t.getDomain()+"/explore/search/advice?"+t.objectToQueryString(e);case"apprenticeshipsForm":return t.subDomain=!1,"https://careerfinder.ucas.com/searchjobs/?"+t.objectToQueryString(e);case"eventsForm":return t.subDomain="www",t.getDomain()+"/explore/search/events?refinementList%5Bevent_type%5D%5B0%5D=conference&refinementList%5Bevent_type%5D%5B1%5D=open-day&refinementList%5Bevent_type%5D%5B2%5D=exhibition&"+t.objectToQueryString(e)}},objectToQueryString:function(e){var o=[];for(var a in e)e.hasOwnProperty(a)&&e[a]&&"_none"!==e[a]&&o.push(encodeURIComponent(a.replace(t.activeFormType,""))+"="+encodeURIComponent(e[a]));return o.join("&")},getDomain:function(){var e=window.location.hostname;if(-1!==e.indexOf(".ucas.com"))return"https://"+t.subDomain+".ucas.com";var o="www"===t.subDomain?"-ucascom":"-"+t.subDomain,a=e.replace(".ucasenvironments.com",""),n=a.split("-");return 1===n.length?"-ucascom"!==o||-1===a.indexOf("ucascom")&&-1===a.indexOf("loadtest")?n=window.hasOwnProperty("Drupal")&&Drupal.hasOwnProperty("settings")&&Drupal.settings.hasOwnProperty("digitalUrl")?Drupal.settings.digitalUrl.replace("https://","").replace("-digital.ucasenvironments.com",""):"pp":(n=a,o=""):n=n[0],t.getCookie("ucasDigitalPinnedEnv")&&(n=t.getCookie("ucasDigitalPinnedEnv")),"https://"+n.replace(/[\W_]+/g,"")+o+".ucasenvironments.com"},getCookie:function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return!!t&&t.pop()},initAutocomplete:function(o){o=o.results;var a=[];o.forEach((function(e){a.push({value:e.providerId,label:e.university,desc:e.region})}));var n=e('input[name="searchTerm"]',t.container).autocomplete({source:a,minLength:2,focus:function(e,t){return!1},open:function(e,t){e.target.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},select:function(e,o){return"_none"===o.item.value||(t.subDomain="www",window.location=t.getDomain()+"/explore/uni-detail/"+o.item.value),!1},response:function(e,t){t.content.length||t.content.push({value:"_none",label:"No results found. Try simplifying your search."})}});n.autocomplete("instance")._renderMenu=function(t,o){var a=this;if(1!==o.length||"_none"!==o[0].value){e(t).append('<li class="ui-menu-divider">Select a uni or college from below</li>'),e.each(o,(function(e,o){a._renderItemData(t,o)}))}else e.each(o,(function(e,o){a._renderItemData(t,o)}))},n.autocomplete("instance")._renderItem=function(t,o){var a=new RegExp(this.term,"ig"),n=o.label.replace(a,(function(e){return'<span style="font-weight: bold;">'+e+"</span>"})),r='<span class="autocomplete-desc">&nbsp;- '+o.desc+"</span>";return e("<li></li>").data("item.autocomplete",o).append('<span class="autocomplete-label">'+n+"</span>"+(o.desc?r:"")).appendTo(t)},n.autocomplete("instance")._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())}}};Drupal.behaviors.UcasGlobalSearch={attach:function(e){var o=e.querySelectorAll(".section-lower-header__search > form");o&&o.forEach((function(e){t.init(e)}))}}}(jQuery);;
